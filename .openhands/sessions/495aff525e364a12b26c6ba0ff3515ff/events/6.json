{"id": 6, "timestamp": "2025-10-07T15:37:50.302493", "source": "environment", "message": "Added workspace context", "cause": 4, "observation": "recall", "content": "Added workspace context", "extras": {"recall_type": "workspace_context", "repo_name": "sheepdestroyer/SheepVibes", "repo_directory": "SheepVibes", "repo_branch": "feat/editable-feed-urls-fixed", "repo_instructions": "# PR Ready to Review Microagent\n\nThis microagent provides guidance for ensuring that pull requests are immediately marked as \"ready to review\" after opening them.\n\n## Purpose\n\nEnsure that all pull requests created in the SheepVibes repository are immediately marked as ready for review, rather than being left as draft PRs.\n\n## Core Rules\n\n1. **Always mark PRs as ready to review** immediately after opening them\n2. **Never leave PRs in draft state** unless explicitly requested by the user\n3. **Apply appropriate labels** when creating PRs\n4. **Follow repository templates** if they exist\n\n## Workflow\n\n### When Creating a Pull Request:\n1. Set `draft: false` when using the `create_pr` function\n2. Include clear, descriptive titles and descriptions\n3. Reference any related issues or context\n4. Ensure code passes local checks and is ready for review before creating the PR\n\n## Implementation Guidelines\n\n1. Use the GitHub API directly via `create_pr` function\n2. Set appropriate labels based on the changes (e.g., \"enhancement\", \"bug\", \"documentation\")\n3. Update relevant documentation files (CHANGELOG.md, TODO.md) as needed\n\n## Error Handling\n\n- If authentication fails, update remote URL with current GITHUB_TOKEN\n- If branch conflicts occur, create a new unique branch name\n- Always verify the PR was created successfully\n\n## Usage Examples\n\nWhen creating a PR for a new feature:\n- Title: \"feat: Add new widget functionality\"\n- Labels: \"enhancement\"\n- Description: Include purpose, changes made, and testing results\n\n## Important Notes\n\n- This microagent focuses on the PR creation process specifically\n- It complements the existing SheepVibes Rules microagent\n- Follow all existing repository rules and testing requirements\n\n## Configuration\n\n- Use environment variable `GITHUB_TOKEN` for authentication\n- Default base branch: `main`\n- Always create meaningful branch names that describe the changes\n\n# SheepVibes Repository Summary\n\n## 1. Purpose\nSheepVibes is a self-hosted RSS/Atom feed aggregator inspired by Netvibes and iGoogle. It allows users to organize feeds into customizable tabs in a grid layout, with real-time updates via Server-Sent Events (SSE).\n\n## 2. General Setup\n- **Backend**: Python Flask application with SQLAlchemy ORM, Redis caching, and APScheduler for background feed updates\n- **Frontend**: Vanilla JavaScript (no frameworks) with HTML/CSS\n- **Database**: SQLite with Flask-Migrate for database migrations\n- **Deployment**: Designed for Podman Pod with systemd/Quadlet management\n\n## 3. Repository Structure\n```\nSheepVibes/\n\u251c\u2500\u2500 .github/workflows/   # CI/CD pipelines\n\u2502   \u251c\u2500\u2500 run-tests.yml   # Main test workflow\n\u2502   \u2514\u2500\u2500 release.yml     # Container image publishing\n\u251c\u2500\u2500 backend/             # Python Flask application\n\u2502   \u251c\u2500\u2500 app.py           # Main Flask application with API endpoints\n\u2502   \u251c\u2500\u2500 feed_service.py  # Feed parsing and update logic\n\u2502   \u251c\u2500\u2500 models.py        # SQLAlchemy database models\n\u2502   \u251c\u2500\u2500 migrations/      # Database migration files\n\u2502   \u251c\u2500\u2500 test_app.py      # API endpoint tests\n\u2502   \u251c\u2500\u2500 test_feed.py     # Feed service tests\n\u2502   \u251c\u2500\u2500 requirements.txt # Production dependencies\n\u2502   \u2514\u2500\u2500 requirements-dev.txt # Development dependencies\n\u251c\u2500\u2500 frontend/            # Vanilla JavaScript UI\n\u2502   \u251c\u2500\u2500 index.html       # Main HTML file\n\u2502   \u251c\u2500\u2500 script.js        # Frontend JavaScript logic\n\u2502   \u2514\u2500\u2500 style.css        # CSS styling\n\u251c\u2500\u2500 pod/                 # Podman deployment configuration\n\u2502   \u2514\u2500\u2500 quadlet/         # Systemd Quadlet unit files\n\u251c\u2500\u2500 scripts/             # Deployment and management scripts\n\u2502   \u251c\u2500\u2500 deploy_pod.sh    # Production deployment script\n\u2502   \u251c\u2500\u2500 rebuild_container.sh # Script to rebuild container image\n\u2502   \u2514\u2500\u2500 run_dev.sh       # Local development script\n\u251c\u2500\u2500 AGENTS.md            # AI agent guidelines\n\u251c\u2500\u2500 CHANGELOG.md         # Project history\n\u251c\u2500\u2500 README.md            # Main documentation\n\u251c\u2500\u2500 TESTING.md           # Testing procedures\n\u2514\u2500\u2500 TODO.md              # Development roadmap\n```\n\n## 4. CI/CD Workflows\n\n### Main Test Workflow (.github/workflows/run-tests.yml)\n- **Trigger**: On every push and pull request\n- **Services**: Redis container for caching (dynamic port mapping)\n- **Key Environment Variable**: `CACHE_REDIS_PORT` - dynamically assigned Redis port\n- **Setup**: Python 3.13 with pip caching\n- **Test Execution**: \n  - Install dependencies from backend/requirements*.txt\n  - Run pytest with `python -m pytest -v` from backend directory\n- **Redis Health Check**: Configured with ping commands\n\n### Release Workflow (.github/workflows/release.yml)\n- **Trigger**: On version tags (v*) or manual dispatch\n- **Actions**: Build and publish container image to GitHub Container Registry\n\n### Dependabot Configuration\n- **Pip**: Daily updates for backend dependencies\n- **GitHub Actions**: Daily updates for workflow files\n\n## 5. Key Features\n- Grid-based feed organization in customizable tabs\n- OPML import/export functionality\n- Real-time UI updates via Server-Sent Events\n- Background feed updates every 15 minutes (configurable)\n- Unread count tracking per feed and tab\n- Feed management (add/delete feeds, create/rename/delete tabs)\n- Persistent data storage with SQLite\n- Redis caching for performance optimization\n\n## 6. Development Requirements\n- **Testing**: Requires running Redis service container\n- **Dynamic Port Handling**: Tests use `CACHE_REDIS_PORT` environment variable\n- Backend tests require Redis for caching functionality\n\n## 7. Deployment Options\n1. **Production**: Podman Pod with systemd/Quadlet (recommended)\n2. **Local Development**: Direct backend/frontend development\n3. **Container Development**: Podman containers with development network\n\n## 8. Configuration Variables\n- `DATABASE_PATH`: SQLite database file location\n- `UPDATE_INTERVAL_MINUTES`: Feed update frequency (default: 15)\n- `CACHE_REDIS_URL`: Redis connection URL\n- `FLASK_APP`: Path to Flask application (default: backend.app)\n- `FLASK_RUN_HOST`: Flask server host (default: 0.0.0.0)\n- `PYTHONPATH`: Module search path (default: /app in container)\n\n# SheepVibes Repository Rules and Guidelines\n\nThis microagent provides comprehensive knowledge about the SheepVibes RSS/Atom feed aggregator repository, including development workflows, testing requirements, and deployment procedures.\n\n## Core Rules for AI Agents\n\n### Mandatory Workflow Steps\n1. **Read all `.md` files** from the repository before starting any task\n2. **Read both backend & frontend code files** to understand the application's logic\n3. **For each individual step** during a task:\n   - Add new relevant tests to the test suite\n   - Verify pre-existing tests are still valid, correct if necessary\n4. **Execute full CI workflow** as described in `.github/workflows/run-tests.yml`\n5. **Before task completion**:\n   - Run final full validation of all tests\n   - Update relevant `.md` files (especially `TODO.md` and `CHANGELOG.md`)\n\n### Testing Requirements\n- **Backend tests** require a running Redis service container\n- **Dynamic port handling** - Redis port is dynamically mapped in CI environments\n- **Environment variable**: Tests look for `CACHE_REDIS_PORT` to override default Redis port\n- **Full test suite execution** is mandatory before proceeding to next steps\n\n## Application Architecture\n\n### Backend (Python/Flask)\n- **Framework**: Flask with SQLAlchemy ORM\n- **Database**: SQLite with migrations\n- **Caching**: Redis for performance optimization\n- **Background tasks**: APScheduler for automatic feed updates\n- **API**: RESTful endpoints for tabs, feeds, and feed items\n\n### Frontend (Vanilla JavaScript)\n- **No frameworks** - pure JavaScript, HTML, CSS\n- **Real-time updates**: Server-Sent Events (SSE) for live feed updates\n- **UI**: Netvibes/iGoogle-inspired grid layout\n\n## Development Environment Setup\n\n### Production Deployment (Podman Pod with systemd/Quadlet)\n- Use `scripts/deploy_pod.sh` for stable deployment\n- Pod includes: app container, Redis container, persistent volumes\n- Auto-start configured via systemd user services\n\n### Local Development Options\n1. **Podman containers** with development network\n2. **Direct backend/frontend** development with virtual environment\n\n## Key Configuration Variables\n- `DATABASE_PATH`: SQLite database file location\n- `UPDATE_INTERVAL_MINUTES`: Feed update frequency (default: 15)\n- `CACHE_REDIS_URL`: Redis connection URL\n\n## Testing Procedures\n\n### Backend Testing\n1. Start Redis container: `podman run -d --rm --name sheepvibes-test-redis -p 6379:6379 redis:alpine`\n2. Install dependencies: `cd backend && pip install -r requirements.txt -r requirements-dev.txt`\n3. Run tests: `python -m pytest -v`\n\n### CI/CD Reference\n- **Definitive guide**: `.github/workflows/run-tests.yml`\n- **Service containerization**: Redis service with dynamic port mapping\n- **Environment setup**: Set `CACHE_REDIS_PORT` for dynamic environments\n\n## Error Handling and Limitations\n- **Feed parsing**: Handle timeouts, invalid URLs, bad feed formats\n- **Database constraints**: Use entry link as GUID to prevent UNIQUE constraint errors\n\n## Usage Examples\nWhen working on this repository, agents must:\n- Always start by reading all markdown files\n- Follow the step-by-step validation workflow\n- Replicate CI environment setup for testing\n- Update documentation files upon task completion\n\n## Important Notes\n- The repository follows a strict validation-first approach\n- All changes must be tested and validated before proceeding\n- Documentation updates are part of the completion criteria", "runtime_hosts": {"http://localhost:52272": 52272, "http://localhost:59953": 59953}, "additional_agent_instructions": "", "date": "2025-10-07", "custom_secrets_descriptions": {}, "conversation_instructions": "Target file: /pr-ready-review.md\n\nDescription: continue to iterate on the pr/review/fix cycle\n\nTriggers: ", "working_dir": "/workspace", "microagent_knowledge": [{"name": "code-review-cycle", "trigger": "review", "content": "# Code Review Cycle Microagent\n\nThis microagent provides guidance for iteratively addressing code reviews through a systematic cycle of review, fix, and re-review.\n\n## Purpose\n\nAutomate the process of addressing code review comments by creating a cycle that:\n1. Waits for code reviews from Google Code Assist and other agents\n2. Addresses all review comments\n3. Closes the current PR\n4. Opens a new PR to trigger fresh reviews\n\n## Core Rules\n\n1. **Wait for reviews**: After creating a PR and marking it ready to review, wait 5 minutes for Google Code Assist and other agents to provide feedback\n2. **Retry if no comments**: If no comments are received after 5 minutes, wait 5 more minutes and try one last time\n3. **Address all comments**: Thoroughly review and implement all feedback from code reviews\n4. **Close and reopen**: Close the current PR and open a new one to trigger fresh reviews\n5. **Maximum 10 cycles**: Repeat the cycle for a maximum of 10 iterations\n\n## Workflow\n\n### Initial Setup:\n1. Create a new branch with a meaningful name that describes the changes\n2. Ensure the branch name is unique to avoid conflicts\n\n### Code Review Cycle (Repeat up to 10 times):\n1. **Create PR**: Open a pull request with clear title and description\n2. **Mark ready**: Immediately mark the PR as ready to review (not draft)\n3. **Wait for reviews**: \n   - Wait 5 minutes for Google Code Assist and other agents to provide feedback\n   - If no comments received, wait 5 more minutes and check one last time\n4. **Review comments**: Read and analyze all code review comments\n5. **Address feedback**: Implement all requested changes and fixes\n6. **Commit changes**: Commit the fixes to the local branch\n7. **Close PR**: Close the current pull request\n8. **Push changes**: Push the latest changes to the branch\n9. **Open new PR**: Create a new pull request to trigger fresh reviews\n\n## Implementation Guidelines\n\n### When Creating Pull Requests:\n1. Use `create_pr` function with `draft: false`\n2. Create meaningful branch names that describe the changes\n3. Follow repository templates if they exist\n4. Apply appropriate labels (e.g., \"enhancement\", \"bug\", \"documentation\")\n5. Include clear descriptions of changes made and purpose\n\n### When Addressing Comments:\n1. Read all comments thoroughly\n2. Implement all requested changes\n3. Verify tests pass after changes\n4. Update documentation (CHANGELOG.md, TODO.md) as needed\n\n## Error Handling\n\n- **Authentication issues**: Update remote URL with current GITHUB_TOKEN\n- **Branch conflicts**: Create new unique branch names\n- **No comments received**: After waiting 10 minutes total, proceed to close and reopen\n- **Maximum cycles reached**: Stop after 10 iterations and report completion\n\n## Usage Examples\n\n### Example Cycle:\n1. Create branch: `feat/code-review-cycle-agent`\n2. Open PR: \"feat: Add code review cycle microagent\"\n3. Wait 5 minutes for reviews\n4. If comments received, address them\n5. Close current PR\n6. Push changes\n7. Open new PR with updated description\n\n## Configuration\n\n- Use environment variable `GITHUB_TOKEN` for authentication\n- Default base branch: `main`\n- Always verify PR creation was successful\n\n## Important Notes\n\n- This microagent complements the existing PR Ready to Review and SheepVibes Rules microagents\n- Follow all repository testing requirements and validation workflows, including running the full test suite before each PR creation.\n- Update relevant documentation files upon completion of each cycle"}]}}