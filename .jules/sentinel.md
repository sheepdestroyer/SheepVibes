## 2026-01-22 - XML Security Hardening
**Vulnerability:** The application used the standard `xml.etree.ElementTree` library to parse untrusted OPML files during import. While the current Python 3.12 environment provided some default mitigation against Billion Laughs (DoS) and XXE attacks (raising "limit on input amplification factor breached"), relying on implicit runtime protections is not a robust security strategy. The code was potentially vulnerable on older Python versions or different configurations.
**Learning:** Defense in Depth requires explicit security controls rather than relying on environment defaults. Implementing `defusedxml` provided immediate, strict rejection of any entity expansion (`EntitiesForbidden`), offering a stronger guarantee than the amplification limits of the standard library.
**Prevention:** Always use `defusedxml.ElementTree` (aliased as `SafeET`) for parsing untrusted XML. Use `xml.etree.ElementTree` (aliased as `StandardET`) only for creating XML output. Ensure `DefusedXmlException` is caught to handle security violations gracefully.
